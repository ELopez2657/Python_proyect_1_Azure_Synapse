{
	"name": "mental_health_ext_tab",
	"properties": {
		"content": {
			"query": "---------------------------------Depression and Mental Health Data Analysis----------------------------------------\n\nIF NOT EXISTS (SELECT * FROM sys.external_file_formats WHERE name = 'SynapseDelimitedTextFormat') \n\tCREATE EXTERNAL FILE FORMAT [SynapseDelimitedTextFormat] \n\tWITH ( FORMAT_TYPE = DELIMITEDTEXT ,\n\t       FORMAT_OPTIONS (\n\t\t\t FIELD_TERMINATOR = ',',\n\t\t\t FIRST_ROW = 2,\n\t\t\t USE_TYPE_DEFAULT = FALSE\n\t\t\t))\nGO\n\nIF NOT EXISTS (SELECT * FROM sys.external_data_sources WHERE name = 'container04_dls01project_dfs_core_windows_net') \n\tCREATE EXTERNAL DATA SOURCE [container04_dls01project_dfs_core_windows_net] \n\tWITH (\n\t\tLOCATION = 'abfss://container04@dls01project.dfs.core.windows.net' \n\t)\nGO\n\nCREATE EXTERNAL TABLE dbo.mental_health_ext_tab (\n\t[Age] nvarchar(40),\n\t[Gender] nvarchar(400),\n\t[Occupation] nvarchar(400),\n\t[Days_Indoors] nvarchar(400),\n\t[Growing_Stress] nvarchar(400),\n\t[Quarantine_Frustrations] nvarchar(400),\n\t[Changes_Habits] nvarchar(400),\n\t[Mental_Health_History] nvarchar(400),\n\t[Weight_Change] nvarchar(400),\n\t[Mood_Swings] nvarchar(400),\n\t[Coping_Struggles] nvarchar(400),\n\t[Work_Interest] nvarchar(400),\n\t[Social_Weakness] nvarchar(400)\n\t)\n\tWITH (\n\tLOCATION = 'mental_health_data/mental_health.csv',\n\tDATA_SOURCE = [container04_dls01project_dfs_core_windows_net],\n\tFILE_FORMAT = [SynapseDelimitedTextFormat]\n\t)\nGO\n\n\nSELECT TOP 100 * FROM dbo.mental_health_ext_tab\nGO;\n\n\n--Age distribution\nselect \n\tAge,\n\tCount(age) as total\nfrom mental_health_ext_tab\ngroup by [Age]\norder by total desc;\n\n--Gender and Age Distribution\nselect\n\tGender,\n\tAge,\n\tCOUNT(*) as total\nfrom mental_health_ext_tab\nGROUP by gender, [Age] \norder by total desc;\n\n-- Most common occupation\nselect \n\t[Occupation],\n\tCOUNT([Occupation]) as Total\nFROM mental_health_ext_tab\nGROUP by [Occupation]\nORDER by total DESC;\n\n--Mental Health History \nSELECT\n\t[Mental_Health_History],\n\tCOUNT([Mental_Health_History]) as Total\nFrom mental_health_ext_tab\nGROUP by [Mental_Health_History]\nORDER by Total DESC;\n\n\n--Distribution of Work Interest\nSELECT\n\t[Work_Interest],\n\tCOUNT([Work_Interest]) as Total\nFrom mental_health_ext_tab\nGROUP by [Work_Interest]\nORDER by Total DESC;\n\n-- Relationship between losing interest in work and problems coping with stress\nSELECT\n\t[Work_Interest] as losing_interest_in_work,\n\t[Coping_Struggles] as problems_coping_with_stress,\n\tCOUNT(*) as Total\nFrom mental_health_ext_tab\nGROUP by [Coping_Struggles], [Work_Interest]\nORDER by Total DESC;\n\n\n--Distribution of Coping Struggles\nSELECT\n\t[Coping_Struggles],\n\tCOUNT([Coping_Struggles]) as Total\nFrom mental_health_ext_tab\nGROUP by [Coping_Struggles]\nORDER by Total DESC;\n\n\n-- Relationship between professions and problems coping with stress\nSELECT\n\t[Occupation],\n\t[Coping_Struggles],\n\tCOUNT(*) as Total\nFrom mental_health_ext_tab\nwhere [Coping_Struggles] = 'Yes'\nGROUP by [Coping_Struggles], [Occupation]\nORDER by Total DESC;\n\n\n--Distribution of Quarantine Frustrations by Mood Swings\nSELECT\n\t[Mood_Swings],\n\t[Quarantine_Frustrations],\n\tCOUNT(*) as Total\nFROM mental_health_ext_tab\nGROUP by [Mood_Swings],[Quarantine_Frustrations]\nORDER by Total DESC;\n\n-- Realtion between Weight Change and Quarantine Frustrations\nSELECT\n\t[Weight_Change],\n\t[Quarantine_Frustrations],\n\tCOUNT(*) as Total\nFROM mental_health_ext_tab\nGROUP by [Weight_Change],[Quarantine_Frustrations]\nORDER by Total DESC;\n\n\n-- Realtion between Weight Change and  Mood Swings\nSELECT\n\t[Weight_Change],\n\t[Mood_Swings],\n\tCOUNT(*) as Total\nFROM mental_health_ext_tab\nGROUP by [Weight_Change],[Mood_Swings]\nORDER by Total DESC;\n\n--Distribution of Weight Change\nSELECT\n\t[Weight_Change],\n\tCOUNT([Weight_Change]) as Total\nFrom mental_health_ext_tab\nGROUP by [Weight_Change]\nORDER by Total DESC;\n\n--Distribution of Quarantine Frustrations\nSELECT\n\t[Quarantine_Frustrations],\n\tCOUNT([Quarantine_Frustrations]) as Total\nFrom mental_health_ext_tab\nGROUP by [Quarantine_Frustrations]\nORDER by Total DESC;\n\n--Relationships Social Weakness and daydays without going out\nSELECT\n    [Days_Indoors],\n\t[Social_Weakness],\n\tCOUNT(*) as Total\nFrom mental_health_ext_tab\nGROUP by [Days_Indoors],[Social_Weakness] \nORDER by Total DESC;\n\n-- https://www.kaggle.com/datasets/shashwatwork/depression-and-mental-health-data-analysis/data\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "mental_health_db",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}